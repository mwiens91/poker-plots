doctype html
head
  meta(name="viewport", content="width=device-width, initial-scale=1")
  meta(content="text/html;charset=utf-8", http-equiv="Content-Type")
  meta(content="utf-8", http-equiv="encoding")
  title poker plots
  // favicon
  link(
    rel="apple-touch-icon",
    sizes="180x180",
    href="favicon/apple-touch-icon.png"
  )
  link(
    rel="icon",
    type="image/png",
    sizes="32x32",
    href="favicon/favicon-32x32.png"
  )
  link(
    rel="icon",
    type="image/png",
    sizes="16x16",
    href="favicon/favicon-16x16.png"
  )
  link(rel="manifest", href="favicon/site.webmanifest")
  // Bootstrap
  link(
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css",
    rel="stylesheet",
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3",
    crossorigin="anonymous"
  )
  script(
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js",
    type="text/javascript",
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p",
    crossorigin="anonymous"
  )
  // D3
  script(src="https://d3js.org/d3.v7.min.js", type="text/javascript")
  // CSS
  link(type="text/css", href="css/style.css", rel="stylesheet")
.container.pt-3
  .row
    .col-6
      div(style={ display: "flex", "justify-content": "center" })
        div(style={ "max-width": "410px" })
          img(
            src="favicon/android-chrome-192x192.png",
            style={ height: "100px", width: "100px" }
          )
          p
            b poker-plots
            |
            | generates a few interactive visualizations of our poker data. It also provides a log of the data.
            br
            br
            | Some features might not be obvious on first use, so click below to see what's available.
          button.btn.btn-outline-primary(
            type="button",
            data-bs-toggle="collapse",
            data-bs-target="#collapseHelp",
            aria-expanded="false",
            aria-controls="collapseHelp"
          ) more info
          #collapseHelp.collapse.pt-4
            h2 More info
            h4 Terms
            ul
              li
                b cumulative sum:
                |
                | how much money a player has accumulated at a given point in time (abbreviated "cum-sum" sometimes)
              li
                b buy-in:
                |
                | the total amount of money a player plays with
              li
                b buy-out:
                |
                | the amount of money a player leaves with
            h4 Features
            h5 People section
            ul
              li hovering over a player's card will highlight their data on the line plot
              li the cards also act as a legend for player colours
            h5 Multi-line chart
            ul
              li hovering over a player's trajectory will highlight their entire trajectory
              li hovering over a player's data point will show the corresponding game's info in the info panel
              li hovering over either of the above will show the player's info in the info panel
              li clicking on a player's data point will scroll to the corresponding game
              li double-clicking anywhere will transform the x-axis from time to serialized games (and vice versa)
              li scrolling will zoom on the x-axis
              li dragging will pan on the x-axis
            h5 Box plot
            ul
              li hovering over a player's "box and whiskers" will show extrema and quartiles
              li hovering over an outlier will show its value
            h5 Pie charts
            ul
              li hovering over a player's arc or label will show their current cumulative sum and percentage of total winnings/losses
            h5 Games log
            ul
              li hovering over a cell will show the total buy-ins
              li clicking on a cell will scroll to the corresponding game
              li a cell's intensity indicates the amount of total buy-ins
            h4 About
            | This page was written by Matt Wiens.#{ ' ' }
            a(href="https://d3js.org/") D3.js
            |
            | is used for data visualization and the most of the styling is courtesy of#{ ' ' }
            a(href="https://getbootstrap.com/") Bootstrap
            | . Ancient browsers and Safari might not be supported. Mobile is going to be a terrible experience. The source code is available#{ ' ' }
            a(href="https://github.com/mwiens91/poker-plots") here
            | .
    .col-6
      div(
        style={ display: "flex", "flex-direction": "column", "justify-content": "center", width: "100%", height: "100%" }
      )
        div
          h2 Quick links
        .link-div
          | >
          button.btn.btn-link(
            onclick="document.getElementById('people').scrollIntoView();"
          )
            | People
        .link-div
          | >
          button.btn.btn-link(
            onclick="document.getElementById('line-chart').scrollIntoView();"
          )
            | Line chart
        .link-div
          | >
          button.btn.btn-link(
            onclick="document.getElementById('box-plot').scrollIntoView();"
          )
            | Box plot
        .link-div
          | >
          button.btn.btn-link(
            onclick="document.getElementById('pie-charts').scrollIntoView();"
          )
            | Pie charts
        .link-div
          | >
          button.btn.btn-link(
            onclick="document.getElementById('games').scrollIntoView();"
          )
            | Games log
  - const parseCurrency = new Intl.NumberFormat("en-US", { style: "currency", currency: "USD" });
  #people.row.pt-5.text-center
    h1 People
    #people-grid.row.pt-3.pb-3(style={ "justify-content": "center" })
      // batch players into N groups
      - const N = 4;
      - let i, j;
      - let playersBatched = [];
      - for (i = 0, j = data.players.length; i < j; i += N) {playersBatched.push(data.players.slice(i, i + N))}
      each playersChunk in playersBatched
        .row.p-0.my-1
          each player in playersChunk
            // Make sure the number after "col" is 12 / N
            .col-3.p-0.g-0
              .player-card(
                id="player-card-" + player.name,
                style={ background: "linear-gradient(55deg, rgb(" + player.colourRgb + ") 0%, rgb(" + player.colourRgb.map((x) => x + (255 - x) * 0.4) + ") 60%)" }
              )
                .row.g-0.align-items-center
                  .col-md-4
                    img.img-fluid.avatar-circle(
                      src=player.avatar,
                      alt=player.name
                    )
                  .col-md-8
                    h5.card-title #{ player.name }
                    | #{ parseCurrency.format(player.cumSum) }
  #line-chart.row.pt-5.text-center
    h1 Cumulative sums multi-line chart
  .row
    #line-plot-parent.col.text-center
  .row.mx-5
    #line-plot-avatar-div.col-2.py-1(style={ "text-align": "center" })
      img#line-plot-avatar.img-fluid.avatar-circle(
        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAABk0lEQVR4nO3SQQkAMAzAwPo3vaoIg3KnII/Mg8D8DuAmY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWCWORMBYJY5EwFgljkTAWiQWlnUTzYEi5dwAAAABJRU5ErkJggg=="
      )
    #line-plot-player-div.col-3.pt-2
      h3#line-plot-player
      #line-plot-amount
    #line-plot-game-div.col-7.pt-2
      h3#line-plot-game-title
      #line-plot-game-info
  #box-plot.row.text-center(style={ "padding-top": "5rem" })
    h1 Cumulative sums box plot
  .row
    #box-plot-parent.col.text-center
  #pie-charts.row.pt-5.pb-4.text-center
    h1 Current cumulative sums pie charts
  .row.pt-4.text-center
    .col-6
      h2 Winners
      #winner-pie-chart-parent
    .col-6
      h2 Losers
      #loser-pie-chart-parent
  #games.row.pt-5.pb-3.text-center
    h1 Games
  #calendar.row.pt-3.pb-4
    #calendar-parent.col.text-center
  each game in data.games
    .row.pt-4(id="game-" + game.id)
      div
        - const theDate = new Date(game.date.replace(/-/g, "/"));
        h3= theDate.toLocaleDateString("en-US", { weekday: "long", year: "numeric", month: "long", day: "numeric" })
      div
        table.table(style={ "table-layout": "fixed" })
          thead
            tr
              th player
              th buy-in
              th buy-out
              th net
          tbody
            each playerData in game.data
              - const playerColour = data.players.filter((x) => x.name === playerData.player)[0].colourRgb.map((x) => x + (255 - x) * 0.8);
              tr(style={ background: "rgb(" + playerColour + ")" })
                th= playerData.player
                td= parseCurrency.format(playerData.buyin)
                td= parseCurrency.format(playerData.buyout)
                td= parseCurrency.format(playerData.delta)
  // script(src="js/main.js", type="module")
  script(src="js/pokerplots.min.js", type="text/javascript")
